\documentclass[10pt]{article}

\usepackage{geometry}
\usepackage[dvipsnames]{xcolor}
\usepackage{graphicx}
\usepackage[catalan]{babel}
\usepackage{listings}

\geometry{vmargin={2cm,1cm}}
\geometry{hmargin={1.5cm,1.5cm}}


\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{##3##}
\fancyhead[R]{Pàg. \thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\newgeometry{left=1.5cm,right=1.5cm,top=2cm,bottom=1cm,headheight=1cm}
\setlength{\headsep}{0cm}
%\cfoot{Pàgina \thepage}

%\pagenumbering{gobble}
% Per ensamblador
\lstdefinelanguage{asm}
{
  alsoletter={.}, % allow dots in keywords
  alsodigit={0x}, % hex numbers are numbers too!
  morekeywords=[1]{ % instructions
    addwf,andwf,clrf,clrw,comf,decf,decfsz,incf,incfsc,iorwf,movf,
    movwf,nop,rlf,rrf,subwf,swapf,xorwf,bcf,bsf,btfsc,btfss,addlw,
    andlw,call,clrwdt,goto,iorlw,movlw,retfie,retlw,return,sleep,
    sublw,xorlw,end
 },
  morecomment=[l]{;},   % mark ; as line comment start
  morecomment=[l]{\#},  % as well as # (even though it is unconventional)
  morestring=[b]",      % mark " as string start/end
  morestring=[b]'       % also mark ' as string start/end
}

\renewcommand{\ttdefault}{pcr} % per posar negreta a listing
\lstdefinestyle{mystyle}{
    %backgroundcolor=\color{gray!20},
    commentstyle=\itshape\color{gray},
    keywordstyle=\bfseries,%\color{Blue},
    numberstyle=\tiny,
    %frameround=tttt,
    %framesep=6pt,
    %frame=none,
    frame=single,
    %framexleftmargin=5pt,
    %xleftmargin=12pt,
    stringstyle=\itshape\color{Purple},
    %basicstyle=\ttfamily\footnotesize,%\small,%\footnotesize,
    basicstyle=\ttfamily\small,%\small,%\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=4,
    inputencoding=utf8,
    captionpos=t,
    extendedchars=true,
    texcl=true,
    literate={ó}{{\'o}}1 {é}{{\'e}}1 {á}{{\'a}}1 {ú}{{\'u}}1 {í}{{\'i}}1 {ò}{{\`o}}1 {è}{{\`e}}1 {à}{{\`a}}1 {ù}{{\`u}}1 {ì}{{\`i}}1 {Ó}{{\'O}}1 {É}{{\'E}}1 {Á}{{\'A}}1 {Ú}{{\'U}}1 {Í}{{\'I}}1 {Ò}{{\`O}}1 {È}{{\`E}}1 {À}{{\`A}}1 {Ù}{{\`U}}1 {Ì}{{\`I}}1 {ç}{{\c{c}}}1 {·}{{.}}1 {`}{\`}1 {'}{\'}1,
}

\lstset{style=mystyle, language=##2##}


\begin{document}

%\lstinputlisting[title=##3##]{##1##}
%\vspace*{-4em}
\lstinputlisting{##1##}

\end{document}
